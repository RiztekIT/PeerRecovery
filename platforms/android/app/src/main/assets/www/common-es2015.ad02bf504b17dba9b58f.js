(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"+/my":function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var s=a("JZFu"),r=a("8Y7J"),n=a("fMxG");let i=(()=>{class e{constructor(e){this.storage=e}getUsers(){return s.a.database().ref("Users")}getRel(e,t){return s.a.database().ref("Relations/"+e.uid+"/"+t)}newcall(e,t){let a={timestamp:s.a.firestore.Timestamp.fromDate(new Date),channel:"",state:!0},r=s.a.database().ref("VideosCall/VideosCall/").push(a).key;a.channel=r,s.a.database().ref("VideosCall/VideosCall/"+r).set(a),s.a.database().ref("VideosCall/VideosCall/"+r+"/Members/"+e.uid).set(!0),s.a.database().ref("VideosCall/VideosCall/"+r+"/Members/"+t.uid).set(!1),s.a.database().ref("VideosCall/VideosCall/"+e.uid+"/"+r).set(t.uid),s.a.database().ref("VideosCall/VideosCall/"+t.uid+"/"+r).set(e.uid),this.keycall=r}getCall(e){return s.a.database().ref("VideosCall/VideosCall/"+e)}hangup(e,t){s.a.database().ref("VideosCall/VideosCall/"+t+"/Members/"+e.uid).set(!1),s.a.database().ref("VideosCall/VideosCall/"+t+"/state").set(!1)}reconnect(e,t){s.a.database().ref("VideosCall/VideosCall/"+t+"/Members/"+e.uid).set(!0),s.a.database().ref("VideosCall/VideosCall/"+t+"/state").set(!0)}answerccall(e,t){s.a.database().ref("VideosCall/VideosCall/"+t+"/Members/"+e.uid).set(!0)}getCalls(e){return s.a.database().ref("VideosCall/VideosCall/"+e.uid)}getUser(e){return s.a.database().ref("Users/"+e)}downloadvideo(e){return s.a.storage().ref("Videos/"+e)}tareaCloudStorage(e,t){return this.storage.upload("Videos/"+e,t)}}return e.ngInjectableDef=r.Qb({factory:function(){return new e(r.Rb(n.a))},token:e,providedIn:"root"}),e})()},"5ek2":function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a("EuEP");class s{}},"74mu":function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return s})),a.d(t,"d",(function(){return l}));const s=(e,t)=>null!==t.closest(e),r=(e,t)=>"string"==typeof e&&e.length>0?Object.assign({"ion-color":!0,["ion-color-"+e]:!0},t):t,n=e=>{const t={};return(e=>void 0!==e?(Array.isArray(e)?e:e.split(" ")).filter(e=>null!=e).map(e=>e.trim()).filter(e=>""!==e):[])(e).forEach(e=>t[e]=!0),t},i=/^[a-z][a-z0-9+\-.]*:/,l=async(e,t,a,s)=>{if(null!=e&&"#"!==e[0]&&!i.test(e)){const r=document.querySelector("ion-router");if(r)return null!=t&&t.preventDefault(),r.push(e,a,s)}return!1}},BAG3:function(e,t,a){"use strict";var s=a("8Y7J"),r=a("MKJQ"),n=a("sZkV"),i=a("SVse"),l=a("EuEP"),o=a("Ig/m"),u=a("iInd");a.d(t,"a",(function(){return b}));var d=s.pb({encapsulation:0,styles:[[""]],data:{}});function c(e){return s.Mb(0,[(e()(),s.rb(0,0,null,null,10,"ion-item",[["lines","full"],["mode","md"]],null,[[null,"click"]],(function(e,t,a){var s=!0;return"click"===t&&(s=!1!==e.component.closeModal(e.context.$implicit)&&s),s}),r.hb,r.t)),s.qb(1,49152,null,0,n.H,[s.h,s.k,s.x],{lines:[0,"lines"],mode:[1,"mode"]},null),(e()(),s.rb(2,0,null,0,2,"ion-avatar",[["slot","start"]],null,null,null,r.P,r.b)),s.qb(3,49152,null,0,n.f,[s.h,s.k,s.x],null,null),(e()(),s.rb(4,0,null,0,0,"img",[],[[8,"src",4]],null,null,null,null)),(e()(),s.rb(5,0,null,0,5,"ion-label",[],null,null,null,r.ib,r.u)),s.qb(6,49152,null,0,n.N,[s.h,s.k,s.x],null,null),(e()(),s.rb(7,0,null,0,1,"h3",[["class","name"]],null,null,null,null,null)),(e()(),s.Kb(8,null,["",""])),(e()(),s.rb(9,0,null,0,1,"p",[["class","detail"]],null,null,null,null,null)),(e()(),s.Kb(10,null,["",""]))],(function(e,t){e(t,1,0,"full","md")}),(function(e,t){e(t,4,0,null==t.context.$implicit?null:t.context.$implicit.photoUrl),e(t,8,0,null==t.context.$implicit?null:t.context.$implicit.displayName),e(t,10,0,null==t.context.$implicit?null:t.context.$implicit.email)}))}function h(e){return s.Mb(0,[(e()(),s.rb(0,0,null,null,11,"ion-header",[["class","ion-no-border"]],null,null,null,r.eb,r.q)),s.qb(1,49152,null,0,n.B,[s.h,s.k,s.x],null,null),(e()(),s.rb(2,0,null,0,9,"ion-toolbar",[["mode","md"]],null,null,null,r.Bb,r.N)),s.qb(3,49152,null,0,n.zb,[s.h,s.k,s.x],{mode:[0,"mode"]},null),(e()(),s.rb(4,0,null,0,4,"ion-buttons",[["slot","start"]],null,null,null,r.T,r.f)),s.qb(5,49152,null,0,n.l,[s.h,s.k,s.x],null,null),(e()(),s.rb(6,0,null,0,2,"ion-back-button",[["defaultHref","home"],["icon","chevron-back-outline"],["mode","md"],["text",""]],null,[[null,"click"]],(function(e,t,a){var r=!0;return"click"===t&&(r=!1!==s.Cb(e,8).onClick(a)&&r),r}),r.Q,r.c)),s.qb(7,49152,null,0,n.g,[s.h,s.k,s.x],{defaultHref:[0,"defaultHref"],icon:[1,"icon"],mode:[2,"mode"],text:[3,"text"]},null),s.qb(8,16384,null,0,n.h,[[2,n.fb],n.Gb,n.d],{defaultHref:[0,"defaultHref"]},null),(e()(),s.rb(9,0,null,0,2,"ion-title",[],null,null,null,r.zb,r.L)),s.qb(10,49152,null,0,n.xb,[s.h,s.k,s.x],null,null),(e()(),s.Kb(-1,0,["Users"])),(e()(),s.rb(12,0,null,null,4,"ion-content",[],null,null,null,r.X,r.j)),s.qb(13,49152,null,0,n.u,[s.h,s.k,s.x],null,null),(e()(),s.rb(14,0,null,0,2,"div",[["class","today_div"]],null,null,null,null,null)),(e()(),s.gb(16777216,null,null,1,null,c)),s.qb(16,278528,null,0,i.j,[s.O,s.K,s.q],{ngForOf:[0,"ngForOf"]},null)],(function(e,t){var a=t.component;e(t,3,0,"md"),e(t,7,0,"home","chevron-back-outline","md",""),e(t,8,0,"home"),e(t,16,0,a.Users)}),null)}function f(e){return s.Mb(0,[(e()(),s.rb(0,0,null,null,1,"app-panics",[],null,null,null,h,d)),s.qb(1,114688,null,0,l.a,[o.a,u.m,n.Fb,n.Hb],null,null)],(function(e,t){e(t,1,0)}),null)}var b=s.nb("app-panics",l.a,f,{},{},[])},EuEP:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var s=a("mrSG");a("Ig/m");class r{constructor(e,t,a,s){this.trackingSVC=e,this.router=t,this.modalController=a,this.navParams=s,this.Users=[]}ngOnInit(){this.user=JSON.parse(sessionStorage.getItem("user")),this.getUser()}getUser(){this.trackingSVC.getUsers().on("value",e=>{this.Users=[],e.forEach(e=>{const t=e.val();t.key=e.key,t.key!=this.user.uid&&(console.log(t),console.log(this.user),this.trackingSVC.getRel(this.user,t.key).once("value",e=>{console.log(e),console.log(e.val()),t.selected=e.val(),e.val()&&this.Users.push(t)}))}),console.log(this.Users)})}selectUser(e){console.log(e),this.trackingSVC.panicselectUser=e}closeModal(e){return s.a(this,void 0,void 0,(function*(){const t=JSON.stringify(e);yield this.modalController.dismiss(t)}))}}},"Ig/m":function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var s=a("JZFu"),r=a("8Y7J");let n=(()=>{class e{constructor(){}updateLocation(e,t,a){let r={lat:e,lng:t,timestamp:s.a.firestore.Timestamp.fromDate(new Date)};s.a.database().ref("Tracking/"+a.uid+"/Current").set(r),s.a.database().ref("Tracking/"+a.uid+"/Historic").push(r)}getLocation(e){return s.a.database().ref("Tracking/"+e.uid+"/Current")}getHistoric(e){return s.a.database().ref("Tracking/"+e.uid+"/Historic")}getUser(e){return s.a.database().ref("Users/"+e)}getPanic(e){return s.a.database().ref("Tracking/Panic/"+e)}getUsers(){return s.a.database().ref("Users")}getRel(e,t){return s.a.database().ref("Relations/"+e.uid+"/"+t)}}return e.ngInjectableDef=r.Qb({factory:function(){return new e},token:e,providedIn:"root"}),e})()},JbSX:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var s=a("wEJo"),r=a("qULd"),n=a("iWo5");const i=(e,t)=>{let a,i;const l=(e,s,r)=>{if("undefined"==typeof document)return;const n=document.elementFromPoint(e,s);n&&t(n)?n!==a&&(u(),o(n,r)):u()},o=(e,t)=>{a=e,i||(i=a);const r=a;Object(s.f)(()=>r.classList.add("ion-activated")),t()},u=(e=!1)=>{if(!a)return;const t=a;Object(s.f)(()=>t.classList.remove("ion-activated")),e&&i!==a&&a.click(),a=void 0};return Object(n.createGesture)({el:e,gestureName:"buttonActiveDrag",threshold:0,onStart:e=>l(e.currentX,e.currentY,r.a),onMove:e=>l(e.currentX,e.currentY,r.b),onEnd:()=>{u(!0),Object(r.e)(),i=void 0}})}},KJxK:function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return n}));var s=a("8Y7J");let r=class{constructor(e,t){this._mapsWrapper=e,this._markerManager=t,this.visible=!0,this.zIndex=1,this.markerClick=new s.m,this.openInfoWindow=!0,this.infoWindow=new s.B,this.draggable=!1,this._observableSubscriptions=[]}ngAfterViewInit(){const e=this.template.nativeElement.getElementsByTagName("agm-info-window");for(let t=e.length-1;t>=0;--t)e[t].parentNode.removeChild(e[t]);this.load().then(()=>{this.onChanges=this.onChangesOverride})}ngAfterContentInit(){this.infoWindow.changes.subscribe(()=>this.handleInfoWindowUpdate())}ngOnChanges(e){this.onChanges(e)}onChanges(e){}onChangesOverride(e){(e.latitude||e.longitude||e.zIndex)&&(this.overlayView.latitude=this.latitude,this.overlayView.longitude=this.longitude,this.overlayView.zIndex=this.zIndex,this.destroy().then(()=>this.load()))}ngOnDestroy(){this.destroy()}destroy(){this.destroyed=!0;const e=this._markerManager.deleteMarker(this.overlayView);return this.overlayView&&(this.overlayView.div&&this.overlayView.remove(),this.overlayView.setMap(null)),this._observableSubscriptions.forEach(e=>e.unsubscribe()),delete this.overlayView,e}handleInfoWindowUpdate(){if(this.infoWindow.length>1)throw new Error("Expected no more than one info window.");this.infoWindow.forEach(e=>{e.hostMarker=this.overlayView})}load(){return this._mapsWrapper.getNativeMap().then(e=>{const t=this.getOverlay(e);return this._markerManager.addMarker(t),this._addEventListeners(),this._markerManager.getNativeMarker(t)}).then(e=>{const t=e.setMap;e.map&&this.overlayView.setMap(e.map),e.setMap=a=>{t.call(e,a),this.overlayView&&this.overlayView.setMap(a)}})}getOverlay(e){this.overlayView=this.overlayView||new google.maps.OverlayView,this.overlayView.iconUrl=" ",this.overlayView.latitude=this.latitude,this.overlayView.longitude=this.longitude,this.overlayView.visible=!1,this.bounds&&(this.overlayView.bounds_=new google.maps.LatLngBounds(new google.maps.LatLng(this.latitude+this.bounds.x.latitude,this.longitude+this.bounds.x.longitude),new google.maps.LatLng(this.latitude+this.bounds.y.latitude,this.longitude+this.bounds.y.longitude)));const t=this.template.nativeElement.children[0],a=e=>{this.template.nativeElement.appendChild(e)};return this.overlayView.remove=function(){this.div&&(this.div.parentNode.removeChild(this.div),a(this.div),delete this.div)},this.overlayView.getDiv=function(){return this.div},this.overlayView.draw=function(){if(!this.div){this.div=t;const e=this.getPanes();if(!e||!e.overlayImage)return;e.overlayImage.appendChild(t)}const e=new google.maps.LatLng(this.latitude,this.longitude),a=this.getProjection();if(!a)return;const s=a.fromLatLngToDivPixel(e);if(s&&(t.style.left=s.x-10+"px",t.style.top=s.y-20+"px"),this.bounds_){const e=this.getProjection(),t=e.fromLatLngToDivPixel(this.bounds_.getSouthWest()),a=e.fromLatLngToDivPixel(this.bounds_.getNorthEast());this.div.style.left=t.x+"px",this.div.style.top=a.y+"px",this.div.children[0].style.width=a.x-t.x+"px",this.div.children[0].style.height=t.y-a.y+"px"}},t.addEventListener("click",e=>{this.handleTap(),e.stopPropagation()}),this.handleInfoWindowUpdate(),this.overlayView}handleTap(){this.openInfoWindow&&this.infoWindow.forEach(e=>{e.open()}),this.markerClick.emit(null)}_addEventListeners(){const e=this._markerManager.createEventObservable("click",this.overlayView).subscribe(()=>this.handleTap());this._observableSubscriptions.push(e)}},n=class{}},"N/pL":function(e,t,a){"use strict";a.r(t),a.d(t,"PanicsPageModuleNgFactory",(function(){return f}));var s=a("8Y7J"),r=a("YbcC"),n=a("pMnS"),i=a("BAG3"),l=a("SVse"),o=a("s7LF"),u=a("sZkV"),d=a("iInd"),c=a("5ek2"),h=a("EuEP"),f=s.ob(r.a,[],(function(e){return s.zb([s.Ab(512,s.j,s.Z,[[8,[n.a,i.a]],[3,s.j],s.v]),s.Ab(4608,l.m,l.l,[s.s,[2,l.v]]),s.Ab(4608,o.o,o.o,[]),s.Ab(4608,u.b,u.b,[s.x,s.g]),s.Ab(4608,u.Fb,u.Fb,[u.b,s.j,s.p]),s.Ab(4608,u.Jb,u.Jb,[u.b,s.j,s.p]),s.Ab(1073742336,l.c,l.c,[]),s.Ab(1073742336,o.n,o.n,[]),s.Ab(1073742336,o.e,o.e,[]),s.Ab(1073742336,u.Bb,u.Bb,[]),s.Ab(1073742336,d.o,d.o,[[2,d.t],[2,d.m]]),s.Ab(1073742336,c.a,c.a,[]),s.Ab(1073742336,r.a,r.a,[]),s.Ab(1024,d.k,(function(){return[[{path:"",component:h.a}]]}),[])])}))},Oz3r:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var s=a("lGQG"),r=a("JZFu"),n=a("8Y7J");let i=(()=>{class e{constructor(e){this.firebaseAuthService=e}getAppointment(e){return r.a.database().ref("Appointments").child(e)}updateAppointment(e,t){return r.a.database().ref("Appointments").child(e).update(t)}getAppointments(){return r.a.database().ref("Appointments/").orderByChild("userID").equalTo(this.firebaseAuthService.usersign.uid)}postAppointment(e){var t=this.firebaseAuthService.usersign.uid+"_"+Date.now();r.a.database().ref("/Appointments/"+t).set(e)}getApps(e){return r.a.database().ref("Appointment/Users/"+e)}addApp(e){console.log(e);let t=r.a.database().ref("Appointment/Apps").push(e).key;r.a.database().ref("Appointment/Users/"+e.user+"/"+t).set(e)}editapp(e){r.a.database().ref("Appointment/Apps/"+e.appkey+"/").set(e),r.a.database().ref("Appointment/Users/"+e.user+"/"+e.appkey).set(e)}}return e.ngInjectableDef=n.Qb({factory:function(){return new e(n.Rb(s.a))},token:e,providedIn:"root"}),e})()},YbcC:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));class s{}},acej:function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return n}));var s=a("1vRN");const r=async(e,t,a,r,n)=>{if(e)return e.attachViewToDom(t,a,n,r);if("string"!=typeof a&&!(a instanceof HTMLElement))throw new Error("framework delegate is missing");const i="string"==typeof a?t.ownerDocument&&t.ownerDocument.createElement(a):a;return r&&r.forEach(e=>i.classList.add(e)),n&&Object.assign(i,n),t.appendChild(i),await new Promise(e=>Object(s.c)(i,e)),i},n=(e,t)=>{if(t){if(e)return e.removeViewFromDom(t.parentElement,t);t.remove()}return Promise.resolve()}},h3R7:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));const s={bubbles:{dur:1e3,circles:9,fn:(e,t,a)=>{const s=e*t/a-e+"ms",r=2*Math.PI*t/a;return{r:5,style:{top:9*Math.sin(r)+"px",left:9*Math.cos(r)+"px","animation-delay":s}}}},circles:{dur:1e3,circles:8,fn:(e,t,a)=>{const s=t/a,r=e*s-e+"ms",n=2*Math.PI*s;return{r:5,style:{top:9*Math.sin(n)+"px",left:9*Math.cos(n)+"px","animation-delay":r}}}},circular:{dur:1400,elmDuration:!0,circles:1,fn:()=>({r:20,cx:48,cy:48,fill:"none",viewBox:"24 24 48 48",transform:"translate(0,0)",style:{}})},crescent:{dur:750,circles:1,fn:()=>({r:26,style:{}})},dots:{dur:750,circles:3,fn:(e,t)=>({r:6,style:{left:9-9*t+"px","animation-delay":-110*t+"ms"}})},lines:{dur:1e3,lines:12,fn:(e,t,a)=>({y1:17,y2:29,style:{transform:`rotate(${30*t+(t<6?180:-180)}deg)`,"animation-delay":e*t/a-e+"ms"}})},"lines-small":{dur:1e3,lines:12,fn:(e,t,a)=>({y1:12,y2:20,style:{transform:`rotate(${30*t+(t<6?180:-180)}deg)`,"animation-delay":e*t/a-e+"ms"}})}}},qULd:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return r})),a.d(t,"d",(function(){return o})),a.d(t,"e",(function(){return l}));const s={getEngine(){const e=window;return e.TapticEngine||e.Capacitor&&e.Capacitor.isPluginAvailable("Haptics")&&e.Capacitor.Plugins.Haptics},available(){return!!this.getEngine()},isCordova:()=>!!window.TapticEngine,isCapacitor:()=>!!window.Capacitor,impact(e){const t=this.getEngine();if(!t)return;const a=this.isCapacitor()?e.style.toUpperCase():e.style;t.impact({style:a})},notification(e){const t=this.getEngine();if(!t)return;const a=this.isCapacitor()?e.style.toUpperCase():e.style;t.notification({style:a})},selection(){this.impact({style:"light"})},selectionStart(){const e=this.getEngine();e&&(this.isCapacitor()?e.selectionStart():e.gestureSelectionStart())},selectionChanged(){const e=this.getEngine();e&&(this.isCapacitor()?e.selectionChanged():e.gestureSelectionChanged())},selectionEnd(){const e=this.getEngine();e&&(this.isCapacitor()?e.selectionEnd():e.gestureSelectionEnd())}},r=()=>{s.selection()},n=()=>{s.selectionStart()},i=()=>{s.selectionChanged()},l=()=>{s.selectionEnd()},o=e=>{s.impact(e)}},rk0U:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var s=a("JZFu"),r=a("8Y7J");let n=(()=>{class e{constructor(){}addReward(e){console.log(e);let t=s.a.database().ref("Rewards/Rewards").push(e).key;s.a.database().ref("Rewards/Tasks/"+t).set(e.task),s.a.database().ref("Rewards/Users/"+e.user+"/"+t).set(e)}getRewards(e){return s.a.database().ref("Rewards/Users/"+e)}editReward(e){console.log(e),s.a.database().ref("Rewards/Rewards/"+e.rewardkey).set(e),s.a.database().ref("Rewards/Tasks/"+e.rewardkey).set(e.task),s.a.database().ref("Rewards/Users/"+e.user+"/"+e.rewardkey).set(e)}addTask(){}removeTask(e){s.a.database().ref("Rewards/Rewards/"+e.rewardkey+"/task").set(e.task),s.a.database().ref("Rewards/Tasks/"+e.rewardkey).set(e.task),s.a.database().ref("Rewards/Users/"+e.user+"/"+e.rewardkey).set(e)}edittask(e,t,a){s.a.database().ref("Rewards/Rewards/"+e.rewardkey+"/task/"+a).set(t),s.a.database().ref("Rewards/Tasks/"+e.rewardkey+"/"+a).set(t),s.a.database().ref("Rewards/Users/"+e.user+"/"+e.rewardkey+"/task/"+a).set(t)}}return e.ngInjectableDef=r.Qb({factory:function(){return new e},token:e,providedIn:"root"}),e})()},sjK5:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var s=a("lGQG"),r=a("XNiG"),n=a("JZFu"),i=a("8Y7J");let l=(()=>{class e{constructor(e){this.firebaseAuthService=e,this.subject=new r.a,this.chatsUsers=[],this.users=[]}getUserChats(){return n.a.database().ref(this.firebaseAuthService.usersign.uid+"/members/")}getChatsMembers(e){return n.a.database().ref(this.firebaseAuthService.usersign.uid+"/members/"+e)}getChats(){return n.a.database().ref(this.firebaseAuthService.usersign.uid+"/chats/")}getUser(e){return n.a.database().ref("Users/"+e)}getUsers(){return n.a.database().ref("Users/")}getRel(e,t){return n.a.database().ref("Relations/"+e.uid+"/"+t)}getChat2(e,t){return n.a.database().ref("Chats/Chats/"+e.uid).orderByValue().equalTo(t)}getChat(e,t){return n.a.database().ref("Chats/Chats/"+e.uid+"/"+t)}getMessages(){return n.a.database().ref("Chats/Messages/"+this.keymessage)}addChat(e,t){let a={name:"single",timestamp:n.a.firestore.Timestamp.fromDate(new Date),members:{user1:e.uid,user2:t.uid}},s=n.a.database().ref("Chats/Chats/").push(a).key;n.a.database().ref("Chats/Chats/"+e.uid+"/"+s).set(t.uid),n.a.database().ref("Chats/Chats/"+t.uid+"/"+s).set(e.uid),this.keymessage=s}addGroup(e,t,a){let s=[];s.push(e.uid);for(let n=0;n<a.length;n++)s.push(a[n].uid);let r={name:t,timestamp:n.a.firestore.Timestamp.fromDate(new Date),members:{users:s}},i=n.a.database().ref("Chats/Chats/").push(r).key;for(let l=0;l<a.length;l++)n.a.database().ref("Chats/Chats/"+e.uid+"/"+i).set(a[l].uid),n.a.database().ref("Chats/Chats/"+a[l].uid+"/"+i).set(e.uid);this.keymessage=i}newChat(e){let t={timestamp:new Date,type:"single"},a=n.a.database().ref(this.firebaseAuthService.usersign.uid+"/chats/").push(t).key;return n.a.database().ref(e.uid+"/chats/"+a).set(t),n.a.database().ref("/chats/"+a).set(t),n.a.database().ref(this.firebaseAuthService.usersign.uid+"/members/"+a+"/"+e.uid).set("true"),n.a.database().ref(this.firebaseAuthService.usersign.uid+"/members/"+a+"/"+this.firebaseAuthService.usersign.uid).set("true"),n.a.database().ref(e.uid+"/members/"+a+"/"+e.uid).set("true"),n.a.database().ref(e.uid+"/members/"+a+"/"+this.firebaseAuthService.usersign.uid).set("true"),n.a.database().ref("/members/"+a+"/"+e.uid).set("true"),n.a.database().ref("/members/"+a+"/"+this.firebaseAuthService.usersign.uid).set("true"),a}newMessage(e){console.log(e);let t=JSON.parse(localStorage.getItem("user2"));n.a.database().ref(this.firebaseAuthService.usersign.uid+"/messages/"+localStorage.getItem("idchat")).push(e),n.a.database().ref(t.uid+"/messages/"+localStorage.getItem("idchat")).push(e),n.a.database().ref("/messages/"+localStorage.getItem("idchat")).push(e)}sendMessage(e,t,a){let s={message:e,timestamp:n.a.firestore.Timestamp.fromDate(new Date),sender:t.uid};n.a.database().ref("Chats/Messages/"+this.keymessage).push(s),n.a.database().ref("Chats/Unread/"+a.uid+"/"+this.keymessage).push(s)}getTokenID(e){return n.a.database().ref("Token/"+e+"/id")}newMessageGroup(e,t){console.log(e),JSON.parse(localStorage.getItem("user2")),n.a.database().ref(this.firebaseAuthService.usersign.uid+"/messages/"+localStorage.getItem("idchat")).push(e),n.a.database().ref("/messages/"+localStorage.getItem("idchat")).push(e),n.a.database().ref("/members/").orderByKey().equalTo(t).on("value",t=>{let a=(e=>{const t=[];return e.forEach(e=>{const a=e.val();t.push(a)}),t})(t);console.log(a),a.forEach(t=>{console.log(t);let a=Object.keys(t).filter(e=>e!=this.firebaseAuthService.usersign.uid&&"key"!=e);console.log(a),a.forEach(t=>{n.a.database().ref(t+"/messages/"+localStorage.getItem("idchat")).push(e)})})})}readChats(){let e=localStorage.getItem("idchat");n.a.database().ref(this.firebaseAuthService.usersign.uid+"/messages/"+e).once("value",t=>{let a=(e=>{const t=[];return e.forEach(e=>{const a=e.val();a.key=e.key,t.push(a)}),t})(t);console.log(a),a.forEach(t=>{t.sender!=this.firebaseAuthService.usersign.uid&&n.a.database().ref(this.firebaseAuthService.usersign.uid+"/messages/"+e+"/"+t.key+"/read").set("true")})})}stopread(){console.log("stop read"),localStorage.getItem("idchat"),n.a.database().ref(this.firebaseAuthService.usersign.uid+"/messages/").off()}unreadChats(e,t){return n.a.database().ref("Chats/Unread/"+e+"/"+t)}cleanUnread(e,t){n.a.database().ref("Chats/Unread/"+e+"/"+t).remove()}newChatGroup(e){let t={timestamp:new Date,type:"group"};console.log(e);let a=n.a.database().ref(this.firebaseAuthService.usersign.uid+"/chats/").push(t).key;return n.a.database().ref("/chats/"+a).set(t),n.a.database().ref(this.firebaseAuthService.usersign.uid+"/members/"+a+"/"+this.firebaseAuthService.usersign.uid).set("true"),n.a.database().ref("/members/"+a+"/"+this.firebaseAuthService.usersign.uid).set("true"),e.forEach(e=>{n.a.database().ref(e.uid+"/members/"+a+"/"+e.uid).set("true"),n.a.database().ref(e.uid+"/members/"+a+"/"+this.firebaseAuthService.usersign.uid).set("true"),n.a.database().ref("/members/"+a+"/"+e.uid).set("true"),n.a.database().ref(this.firebaseAuthService.usersign.uid+"/members/"+a+"/"+e.uid).set("true"),n.a.database().ref(e.uid+"/chats/"+a).set(t)}),a}getUsersChat(e){return n.a.database().ref("Chats/Chats/"+e.uid)}getChatType(e){return n.a.database().ref("Chats/Chats/"+e)}}return e.ngInjectableDef=i.Qb({factory:function(){return new e(i.Rb(s.a))},token:e,providedIn:"root"}),e})()}}]);