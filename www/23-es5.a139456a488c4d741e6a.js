function _defineProperties(n,l){for(var e=0;e<l.length;e++){var t=l[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(n,t.key,t)}}function _createClass(n,l,e){return l&&_defineProperties(n.prototype,l),e&&_defineProperties(n,e),n}function _classCallCheck(n,l){if(!(n instanceof l))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{Wrxl:function(n,l,e){"use strict";e.r(l);var t=e("8Y7J"),o=function n(){_classCallCheck(this,n)},u=e("pMnS"),s=e("SVse"),i=e("MKJQ"),a=e("sZkV"),c=e("s7LF"),r=e("lGQG"),g=e("sjK5"),b=e("yp2w"),h=function(){function n(l,e,t,o,u,s,i){var a=this;_classCallCheck(this,n),this.nav=l,this.route=e,this.router=t,this.firebaseAuthService=o,this.chatService=u,this.http=s,this.http2=i,this.ID_Chat="",this.message="",this.chatMessages=[],this.messages=[],this.route.queryParams.subscribe((function(n){if(n&&n.data){var l=JSON.parse(n.data);l=JSON.parse(l),a.parametros=!0,a.chatService.keymessage=l.key,a.chatUser=l.chatuser}}))}return _createClass(n,[{key:"ngOnInit",value:function(){this.user=JSON.parse(sessionStorage.getItem("user")),this.parametros||(this.chatUser=this.chatService.user2,console.log(this.chatUser,"USER")),this.getMessages()}},{key:"getUserWith",value:function(){JSON.parse(localStorage.getItem("user2"))?(this.chatUser=JSON.parse(localStorage.getItem("user2")),console.log(this.chatUser)):(this.chatUser=JSON.parse(localStorage.getItem("users2")),console.log(this.chatUser))}},{key:"ngOnDestroy",value:function(){this.chatService.stopread()}},{key:"getChat",value:function(){}},{key:"sendMessage",value:function(){var n=this;console.log(this.message),console.log(this.message),this.chatService.sendMessage(this.message,this.firebaseAuthService.usersign,this.chatUser),this.message="",this.chatService.getTokenID(this.chatUser.uid).once("value",(function(l){console.log(l.val(),"USERS"),n.sendMessageNoti(n.message,n.chatService.keymessage,l.val(),n.chatUser)}))}},{key:"sendMessageNoti",value:function(n,l,e,t){var o={key:l,m:n,user:t};console.log(o,"data"),console.log(e,"U"),this.http2.post("https://fcm.googleapis.com/fcm/send",{notification:{title:"PeerRecovery",body:"New Message",sound:"default",click_action:"FCM_PLUGIN_ACTIVITY",icon:"fcm_push_icon"},data:{landing_page:"chat",data:o},to:e,priority:"high",restricted_package_name:""},{headers:{Authorization:"key=AAAA7CwLHfI:APA91bGdbyFJFwO4xWEBilRVInU37vOoQ5jURZv0PHbD8zXc4pT58GEy1ETkskaOfIJEhHtR4YYMr4SbDRiuEI7BJG0JfoXDbguV691brsZri_bLqMQLc-FWffr1EakQsurEnb0ZrN2_","Content-Type":"application/json"}}).subscribe((function(n){console.log(n)}))}},{key:"goToChatList",value:function(){this.nav.navigateBack("/chat"),localStorage.removeItem("user2"),localStorage.removeItem("users2"),localStorage.removeItem("idchat")}},{key:"scrollToBottom",value:function(){this.content.scrollToBottom(300)}},{key:"eventoMensaje",value:function(n){console.log(n),13==n&&this.sendMessage()}},{key:"getMessages",value:function(){var n=this;this.chatService.getMessages().orderByChild("timestamp").on("value",(function(l){n.messages=[],l.forEach((function(l){var e=l.val();console.log(l.val()),n.chatService.getUser(e.sender).on("value",(function(l){e.senderuser=l.val(),n.messages.push(e),n.chatMessages=n.messages})),setTimeout((function(){n.scrollToBottom()}),500)})),console.log(n.messages)})),this.chatService.cleanUnread(this.user.uid,this.chatService.keymessage)}}]),n}(),d=e("iInd"),p=e("IheW"),m=t.pb({encapsulation:0,styles:[["ion-header[_ngcontent-%COMP%]   ion-back-button[_ngcontent-%COMP%]{color:var(--blue)}ion-header[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{color:var(--blue);text-align:center;font-size:18px;font-family:sf_ui_sb;text-transform:capitalize}ion-content[_ngcontent-%COMP%]   .td_lbl[_ngcontent-%COMP%]{font-size:12px;color:var(--blue);font-family:sf_ui_md;text-align:center;margin-top:12px;margin-bottom:12px}ion-content[_ngcontent-%COMP%]   .chat_div[_ngcontent-%COMP%]{display:flex;margin-bottom:20px;align-items:center}ion-content[_ngcontent-%COMP%]   .chat_div[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:57px;width:57px;border-radius:50%;border:solid 3px var(--white);box-shadow:0 0 5px 0 rgba(31,140,237,.25)}ion-content[_ngcontent-%COMP%]   .chat_div[_ngcontent-%COMP%]   .message_div[_ngcontent-%COMP%]   .chat[_ngcontent-%COMP%]{width:230px;box-shadow:0 0 3px 0 rgba(0,0,0,.3);padding:15px;margin-left:15px;border-radius:5px}ion-content[_ngcontent-%COMP%]   .chat_div[_ngcontent-%COMP%]   .message_div[_ngcontent-%COMP%]   .chat[_ngcontent-%COMP%]   .chat_lbl[_ngcontent-%COMP%]{font-size:14px;color:var(--blue);font-family:sf_ui_md_i;margin-top:0;margin-bottom:5px}ion-content[_ngcontent-%COMP%]   .chat_div[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{font-size:12px;color:var(--lht_blue);font-family:sf_ui_md;margin-top:8px;margin-bottom:0;text-align:end}ion-content[_ngcontent-%COMP%]   .replay_div[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}ion-content[_ngcontent-%COMP%]   .replay_div[_ngcontent-%COMP%]   .message_div[_ngcontent-%COMP%]   .chat[_ngcontent-%COMP%]{width:250px;margin-right:15px;margin-left:0;background-color:var(--my_theme);box-shadow:none}ion-content[_ngcontent-%COMP%]   .replay_div[_ngcontent-%COMP%]   .message_div[_ngcontent-%COMP%]   .chat[_ngcontent-%COMP%]   .chat_lbl[_ngcontent-%COMP%]{color:var(--white)}ion-content[_ngcontent-%COMP%]   .replay_div[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{text-align:start}ion-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;box-shadow:0 -1px 6px 0 rgba(0,0,0,.2)}ion-footer[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{width:100%}ion-footer[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{font-size:12px;font-family:rubik_i;color:var(--gray)}ion-footer[_ngcontent-%COMP%]   .send_btn[_ngcontent-%COMP%]{height:50px;width:50px;--background:var(--my_theme);margin:0;--border-radius:0px;min-width:50px;--padding-start:0;--padding-end:0}ion-footer[_ngcontent-%COMP%]   .send_btn[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{width:27px;height:27px}"]],data:{}});function f(n){return t.Mb(0,[(n()(),t.rb(0,0,null,null,7,"div",[["class","chat_div "]],null,null,null,null,null)),(n()(),t.rb(1,0,null,null,6,"div",[["class","message_div "]],null,null,null,null,null)),(n()(),t.rb(2,0,null,null,2,"div",[["class","chat "]],null,null,null,null,null)),(n()(),t.rb(3,0,null,null,1,"p",[["class","chat_lbl "]],null,null,null,null,null)),(n()(),t.Kb(4,null,["",""])),(n()(),t.rb(5,0,null,null,2,"p",[["class","time "]],null,null,null,null,null)),(n()(),t.Kb(6,null,["",""])),t.Gb(7,2)],null,(function(n,l){n(l,4,0,l.parent.context.$implicit.message);var e=t.Lb(l,6,0,n(l,7,0,t.Cb(l.parent.parent,0),1e3*l.parent.context.$implicit.timestamp.seconds,"dd/MM/yy h:mm a"));n(l,6,0,e)}))}function v(n){return t.Mb(0,[(n()(),t.rb(0,0,null,null,7,"div",[["class","chat_div replay_div "]],null,null,null,null,null)),(n()(),t.rb(1,0,null,null,6,"div",[["class","message_div "]],null,null,null,null,null)),(n()(),t.rb(2,0,null,null,2,"div",[["class","chat "]],null,null,null,null,null)),(n()(),t.rb(3,0,null,null,1,"p",[["class","chat_lbl "]],null,null,null,null,null)),(n()(),t.Kb(4,null,["",""])),(n()(),t.rb(5,0,null,null,2,"p",[["class","time "]],null,null,null,null,null)),(n()(),t.Kb(6,null,["",""])),t.Gb(7,2)],null,(function(n,l){n(l,4,0,l.parent.context.$implicit.message);var e=t.Lb(l,6,0,n(l,7,0,t.Cb(l.parent.parent,0),1e3*l.parent.context.$implicit.timestamp.seconds,"dd/MM/yy h:mm a"));n(l,6,0,e)}))}function _(n){return t.Mb(0,[(n()(),t.rb(0,0,null,null,4,"div",[],null,null,null,null,null)),(n()(),t.gb(16777216,null,null,1,null,f)),t.qb(2,16384,null,0,s.k,[t.O,t.K],{ngIf:[0,"ngIf"]},null),(n()(),t.gb(16777216,null,null,1,null,v)),t.qb(4,16384,null,0,s.k,[t.O,t.K],{ngIf:[0,"ngIf"]},null)],(function(n,l){var e=l.component;n(l,2,0,l.context.$implicit.sender!=e.firebaseAuthService.usersign.uid),n(l,4,0,l.context.$implicit.sender==e.firebaseAuthService.usersign.uid)}),null)}function C(n){return t.Mb(0,[t.Eb(0,s.e,[t.s]),t.Ib(671088640,1,{content:0}),(n()(),t.rb(2,0,null,null,15,"ion-header",[["class","ion-no-border"]],null,null,null,i.eb,i.q)),t.qb(3,49152,null,0,a.B,[t.h,t.k,t.x],null,null),(n()(),t.rb(4,0,null,0,13,"ion-toolbar",[["mode","md"]],null,null,null,i.Bb,i.N)),t.qb(5,49152,null,0,a.zb,[t.h,t.k,t.x],{mode:[0,"mode"]},null),(n()(),t.rb(6,0,null,0,4,"ion-buttons",[["slot","start"]],null,null,null,i.T,i.f)),t.qb(7,49152,null,0,a.l,[t.h,t.k,t.x],null,null),(n()(),t.rb(8,0,null,0,2,"ion-back-button",[["defaultHref","chatList"],["icon","chevron-back-outline"],["mode","md"],["text",""]],null,[[null,"click"]],(function(n,l,e){var o=!0,u=n.component;return"click"===l&&(o=!1!==t.Cb(n,10).onClick(e)&&o),"click"===l&&(o=!1!==u.goToChatList()&&o),o}),i.Q,i.c)),t.qb(9,49152,null,0,a.g,[t.h,t.k,t.x],{defaultHref:[0,"defaultHref"],icon:[1,"icon"],mode:[2,"mode"],text:[3,"text"]},null),t.qb(10,16384,null,0,a.h,[[2,a.fb],a.Gb,a.d],{defaultHref:[0,"defaultHref"]},null),(n()(),t.rb(11,0,null,0,3,"ion-buttons",[["slot","end"]],null,null,null,i.T,i.f)),t.qb(12,49152,null,0,a.l,[t.h,t.k,t.x],null,null),(n()(),t.rb(13,0,null,0,1,"ion-menu-button",[],null,null,null,i.lb,i.y)),t.qb(14,49152,null,0,a.R,[t.h,t.k,t.x],null,null),(n()(),t.rb(15,0,null,0,2,"ion-title",[],null,null,null,i.zb,i.L)),t.qb(16,49152,null,0,a.xb,[t.h,t.k,t.x],null,null),(n()(),t.Kb(-1,0,["chat"])),(n()(),t.rb(18,0,null,null,4,"ion-header",[],null,null,null,i.eb,i.q)),t.qb(19,49152,null,0,a.B,[t.h,t.k,t.x],null,null),(n()(),t.rb(20,0,null,0,2,"ion-title",[],null,null,null,i.zb,i.L)),t.qb(21,49152,null,0,a.xb,[t.h,t.k,t.x],null,null),(n()(),t.Kb(22,0,["",""])),(n()(),t.rb(23,0,null,null,0,"hr",[],null,null,null,null,null)),(n()(),t.rb(24,0,null,null,3,"ion-content",[["class","ion-padding-horizontal"]],null,null,null,i.X,i.j)),t.qb(25,49152,[[1,4],["chatcontent",4]],0,a.u,[t.h,t.k,t.x],{scrollEvents:[0,"scrollEvents"]},null),(n()(),t.gb(16777216,null,0,1,null,_)),t.qb(27,278528,null,0,s.j,[t.O,t.K,t.q],{ngForOf:[0,"ngForOf"]},null),(n()(),t.rb(28,0,null,null,14,"ion-footer",[["class","ion-no-border "]],null,null,null,i.cb,i.o)),t.qb(29,49152,null,0,a.z,[t.h,t.k,t.x],null,null),(n()(),t.rb(30,0,null,0,8,"ion-item",[["lines","none "],["mode","md"]],null,null,null,i.hb,i.t)),t.qb(31,49152,null,0,a.H,[t.h,t.k,t.x],{lines:[0,"lines"],mode:[1,"mode"]},null),(n()(),t.rb(32,0,null,0,6,"ion-input",[["placeholder","Type your message... "],["style","font-size: 20px !important;"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"keypress"],[null,"ionBlur"],[null,"ionChange"]],(function(n,l,e){var o=!0,u=n.component;return"ionBlur"===l&&(o=!1!==t.Cb(n,33)._handleBlurEvent(e.target)&&o),"ionChange"===l&&(o=!1!==t.Cb(n,33)._handleInputEvent(e.target)&&o),"ngModelChange"===l&&(o=!1!==(u.message=e)&&o),"keypress"===l&&(o=!1!==u.eventoMensaje(e.keyCode)&&o),o}),i.gb,i.s)),t.qb(33,4341760,null,0,a.Nb,[t.p,t.k],null,null),t.Hb(1024,null,c.f,(function(n){return[n]}),[a.Nb]),t.qb(35,671744,null,0,c.k,[[8,null],[8,null],[8,null],[6,c.f]],{model:[0,"model"]},{update:"ngModelChange"}),t.Hb(2048,null,c.g,null,[c.k]),t.qb(37,16384,null,0,c.h,[[4,c.g]],null,null),t.qb(38,49152,null,0,a.G,[t.h,t.k,t.x],{placeholder:[0,"placeholder"]},null),(n()(),t.rb(39,0,null,0,3,"ion-button",[["class","send_btn"]],null,[[null,"click"]],(function(n,l,e){var t=!0;return"click"===l&&(t=!1!==n.component.sendMessage()&&t),t}),i.S,i.e)),t.qb(40,49152,null,0,a.k,[t.h,t.k,t.x],null,null),(n()(),t.rb(41,0,null,0,1,"ion-icon",[["src","../../../assets/image_icon/send.svg "]],null,null,null,i.fb,i.r)),t.qb(42,49152,null,0,a.C,[t.h,t.k,t.x],{src:[0,"src"]},null)],(function(n,l){var e=l.component;n(l,5,0,"md"),n(l,9,0,"chatList","chevron-back-outline","md",""),n(l,10,0,"chatList"),n(l,25,0,!0),n(l,27,0,e.chatMessages),n(l,31,0,"none ","md"),n(l,35,0,e.message),n(l,38,0,"Type your message... "),n(l,42,0,"../../../assets/image_icon/send.svg ")}),(function(n,l){n(l,22,0,l.component.chatUser.displayName),n(l,32,0,t.Cb(l,37).ngClassUntouched,t.Cb(l,37).ngClassTouched,t.Cb(l,37).ngClassPristine,t.Cb(l,37).ngClassDirty,t.Cb(l,37).ngClassValid,t.Cb(l,37).ngClassInvalid,t.Cb(l,37).ngClassPending)}))}var M=t.nb("app-chat",h,(function(n){return t.Mb(0,[(n()(),t.rb(0,0,null,null,1,"app-chat",[],null,null,null,C,m)),t.qb(1,245760,null,0,h,[a.Gb,d.a,d.m,r.a,g.a,b.a,p.c],null,null)],(function(n,l){n(l,1,0)}),null)}),{},{},[]),x=function n(){_classCallCheck(this,n)};e.d(l,"ChatPageModuleNgFactory",(function(){return k}));var k=t.ob(o,[],(function(n){return t.zb([t.Ab(512,t.j,t.Z,[[8,[u.a,M]],[3,t.j],t.v]),t.Ab(4608,s.m,s.l,[t.s,[2,s.v]]),t.Ab(4608,c.o,c.o,[]),t.Ab(4608,a.b,a.b,[t.x,t.g]),t.Ab(4608,a.Fb,a.Fb,[a.b,t.j,t.p]),t.Ab(4608,a.Jb,a.Jb,[a.b,t.j,t.p]),t.Ab(1073742336,s.c,s.c,[]),t.Ab(1073742336,c.n,c.n,[]),t.Ab(1073742336,c.e,c.e,[]),t.Ab(1073742336,a.Bb,a.Bb,[]),t.Ab(1073742336,d.o,d.o,[[2,d.t],[2,d.m]]),t.Ab(1073742336,x,x,[]),t.Ab(1073742336,o,o,[]),t.Ab(1024,d.k,(function(){return[[{path:"",component:h}]]}),[])])}))}}]);